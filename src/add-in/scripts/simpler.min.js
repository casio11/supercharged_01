"use strict";function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(r,!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t():e.numeral=t()}(window,(function(){function e(e,t){this._input=e,this._value=t}var t,r,n={},a={},i={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},o={currentLocale:i.currentLocale,zeroFormat:i.zeroFormat,nullFormat:i.nullFormat,defaultFormat:i.defaultFormat,scalePercentBy100:i.scalePercentBy100};return(t=function(a){var i,l,u,c;if(t.isNumeral(a))i=a.value();else if(0===a||void 0===a)i=0;else if(null===a||r.isNaN(a))i=null;else if("string"==typeof a)if(o.zeroFormat&&a===o.zeroFormat)i=0;else if(o.nullFormat&&a===o.nullFormat||!a.replace(/[^0-9]+/g,"").length)i=null;else{for(l in n)if((c="function"==typeof n[l].regexps.unformat?n[l].regexps.unformat():n[l].regexps.unformat)&&a.match(c)){u=n[l].unformat;break}i=(u=u||t._.stringToNumber)(a)}else i=Number(a)||null;return new e(a,i)}).version="2.0.6",t.isNumeral=function(t){return t instanceof e},t._=r={numberToFormat:function(e,r,n){var i,o,l,u,c,s,m,f,d=a[t.options.currentLocale],p=!1,h=!1,b="",y=1e12,v="",g=!1;if(e=e||0,o=Math.abs(e),t._.includes(r,"(")?(p=!0,r=r.replace(/[\(|\)]/g,"")):(t._.includes(r,"+")||t._.includes(r,"-"))&&(c=t._.includes(r,"+")?r.indexOf("+"):0>e?r.indexOf("-"):-1,r=r.replace(/[\+|\-]/g,"")),t._.includes(r,"a")&&(i=!!(i=r.match(/a(k|m|b|t)?/))&&i[1],t._.includes(r," a")&&(b=" "),r=r.replace(new RegExp(b+"a[kmbt]?"),""),o>=y&&!i||"t"===i?(b+=d.abbreviations.trillion,e/=y):y>o&&o>=1e9&&!i||"b"===i?(b+=d.abbreviations.billion,e/=1e9):1e9>o&&o>=1e6&&!i||"m"===i?(b+=d.abbreviations.million,e/=1e6):(1e6>o&&o>=1e3&&!i||"k"===i)&&(b+=d.abbreviations.thousand,e/=1e3)),t._.includes(r,"[.]")&&(h=!0,r=r.replace("[.]",".")),l=e.toString().split(".")[0],u=r.split(".")[1],s=r.indexOf(","),f=(r.split(".")[0].split(",")[0].match(/0/g)||[]).length,u?(t._.includes(u,"[")?(u=(u=u.replace("]","")).split("["),v=t._.toFixed(e,u[0].length+u[1].length,n,u[1].length)):v=t._.toFixed(e,u.length,n),l=v.split(".")[0],v=t._.includes(v,".")?d.delimiters.decimal+v.split(".")[1]:"",h&&0===Number(v.slice(1))&&(v="")):l=t._.toFixed(e,0,n),b&&!i&&Number(l)>=1e3&&b!==d.abbreviations.trillion)switch(l=String(Number(l)/1e3),b){case d.abbreviations.thousand:b=d.abbreviations.million;break;case d.abbreviations.million:b=d.abbreviations.billion;break;case d.abbreviations.billion:b=d.abbreviations.trillion}if(t._.includes(l,"-")&&(l=l.slice(1),g=!0),l.length<f)for(var _=f-l.length;_>0;_--)l="0"+l;return s>-1&&(l=l.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),0===r.indexOf(".")&&(l=""),m=l+v+(b||""),p?m=(p&&g?"(":"")+m+(p&&g?")":""):c>=0?m=0===c?(g?"-":"+")+m:m+(g?"-":"+"):g&&(m="-"+m),m},stringToNumber:function(e){var t,r,n,i=a[o.currentLocale],l=e,u={thousand:3,million:6,billion:9,trillion:12};if(o.zeroFormat&&e===o.zeroFormat)r=0;else if(o.nullFormat&&e===o.nullFormat||!e.replace(/[^0-9]+/g,"").length)r=null;else{for(t in r=1,"."!==i.delimiters.decimal&&(e=e.replace(/\./g,"").replace(i.delimiters.decimal,".")),u)if(n=new RegExp("[^a-zA-Z]"+i.abbreviations[t]+"(?:\\)|(\\"+i.currency.symbol+")?(?:\\))?)?$"),l.match(n)){r*=Math.pow(10,u[t]);break}r*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,e=e.replace(/[^0-9\.]+/g,""),r*=Number(e)}return r},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return"number"==typeof e&&isNaN(e)})),includes:function(e,t){return-1!==e.indexOf(t)},insert:function(e,t,r){return e.slice(0,r)+t+e.slice(r)},reduce:function(e,t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var r,n=Object(e),a=n.length>>>0,i=0;if(3===arguments.length)r=arguments[2];else{for(;a>i&&!(i in n);)i++;if(i>=a)throw new TypeError("Reduce of empty array with no initial value");r=n[i++]}for(;a>i;i++)i in n&&(r=t(r,n[i],i,n));return r},multiplier:function(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)},correctionFactor:function(){var e=Array.prototype.slice.call(arguments);return e.reduce((function(e,t){var n=r.multiplier(t);return e>n?e:n}),1)},toFixed:function(e,t,r,n){var a,i,o,l,u=e.toString().split("."),c=t-(n||0);return a=2===u.length?Math.min(Math.max(u[1].length,c),t):c,o=Math.pow(10,a),l=(r(e+"e+"+a)/o).toFixed(a),n>t-a&&(i=new RegExp("\\.?0{1,"+(n-(t-a))+"}$"),l=l.replace(i,"")),l}},t.options=o,t.formats=n,t.locales=a,t.locale=function(e){return e&&(o.currentLocale=e.toLowerCase()),o.currentLocale},t.localeData=function(e){if(!e)return a[o.currentLocale];if(e=e.toLowerCase(),!a[e])throw new Error("Unknown locale : "+e);return a[e]},t.reset=function(){for(var e in i)o[e]=i[e]},t.zeroFormat=function(e){o.zeroFormat="string"==typeof e?e:null},t.nullFormat=function(e){o.nullFormat="string"==typeof e?e:null},t.defaultFormat=function(e){o.defaultFormat="string"==typeof e?e:"0.0"},t.register=function(e,t,r){if(t=t.toLowerCase(),this[e+"s"][t])throw new TypeError(t+" "+e+" already registered.");return this[e+"s"][t]=r,r},t.validate=function(e,r){var n,a,i,o,l,u,c,s;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),(e=e.trim()).match(/^\d+$/))return!0;if(""===e)return!1;try{c=t.localeData(r)}catch(e){c=t.localeData(t.locale())}return i=c.currency.symbol,l=c.abbreviations,n=c.delimiters.decimal,a="."===c.delimiters.thousands?"\\.":c.delimiters.thousands,(null===(s=e.match(/^[^\d]+/))||(e=e.substr(1),s[0]===i))&&((null===(s=e.match(/[^\d]+$/))||(e=e.slice(0,-1),s[0]===l.thousand||s[0]===l.million||s[0]===l.billion||s[0]===l.trillion))&&(u=new RegExp(a+"{2}"),!e.match(/[^\d.,]/g)&&(!((o=e.split(n)).length>2)&&(o.length<2?!!o[0].match(/^\d+.*\d$/)&&!o[0].match(u):1===o[0].length?!!o[0].match(/^\d+$/)&&!o[0].match(u)&&!!o[1].match(/^\d+$/):!!o[0].match(/^\d+.*\d$/)&&!o[0].match(u)&&!!o[1].match(/^\d+$/)))))},t.fn=e.prototype={clone:function(){return t(this)},format:function(e,r){var a,i,l,u=this._value,c=e||o.defaultFormat;if(r=r||Math.round,0===u&&null!==o.zeroFormat)i=o.zeroFormat;else if(null===u&&null!==o.nullFormat)i=o.nullFormat;else{for(a in n)if(c.match(n[a].regexps.format)){l=n[a].format;break}i=(l=l||t._.numberToFormat)(u,c,r)}return i},value:function(){return this._value},input:function(){return this._input},set:function(e){return this._value=Number(e),this},add:function(e){var t=r.correctionFactor.call(null,this._value,e);return this._value=r.reduce([this._value,e],(function(e,r,n,a){return e+Math.round(t*r)}),0)/t,this},subtract:function(e){var t=r.correctionFactor.call(null,this._value,e);return this._value=r.reduce([e],(function(e,r,n,a){return e-Math.round(t*r)}),Math.round(this._value*t))/t,this},multiply:function(e){return this._value=r.reduce([this._value,e],(function(e,t,n,a){var i=r.correctionFactor(e,t);return Math.round(e*i)*Math.round(t*i)/Math.round(i*i)}),1),this},divide:function(e){return this._value=r.reduce([this._value,e],(function(e,t,n,a){var i=r.correctionFactor(e,t);return Math.round(e*i)/Math.round(t*i)})),this},difference:function(e){return Math.abs(t(this._value).subtract(e).value())}},t.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),t.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(e,r,n){var a,i=t._.includes(r," BPS")?" ":"";return e*=1e4,r=r.replace(/\s?BPS/,""),a=t._.numberToFormat(e,r,n),t._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"BPS"),a=a.join("")):a=a+i+"BPS",a},unformat:function(e){return+(1e-4*t._.stringToNumber(e)).toFixed(15)}}),function(){var e={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},r={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},n=e.suffixes.concat(r.suffixes.filter((function(t){return e.suffixes.indexOf(t)<0}))).join("|");n="("+n.replace("B","B(?!PS)")+")",t.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(n)},format:function(n,a,i){var o,l,u,c=t._.includes(a,"ib")?r:e,s=t._.includes(a," b")||t._.includes(a," ib")?" ":"";for(a=a.replace(/\s?i?b/,""),o=0;o<=c.suffixes.length;o++)if(l=Math.pow(c.base,o),u=Math.pow(c.base,o+1),null===n||0===n||n>=l&&u>n){s+=c.suffixes[o],l>0&&(n/=l);break}return t._.numberToFormat(n,a,i)+s},unformat:function(n){var a,i,o=t._.stringToNumber(n);if(o){for(a=e.suffixes.length-1;a>=0;a--){if(t._.includes(n,e.suffixes[a])){i=Math.pow(e.base,a);break}if(t._.includes(n,r.suffixes[a])){i=Math.pow(r.base,a);break}}o*=i||1}return o}})}(),t.register("format","currency",{regexps:{format:/(\$)/},format:function(e,r,n){var a,i,o=t.locales[t.options.currentLocale],l={before:r.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:r.match(/([\+|\-|\)|\s|\$]*)$/)[0]};for(r=r.replace(/\s?\$\s?/,""),a=t._.numberToFormat(e,r,n),e>=0?(l.before=l.before.replace(/[\-\(]/,""),l.after=l.after.replace(/[\-\)]/,"")):0>e&&!t._.includes(l.before,"-")&&!t._.includes(l.before,"(")&&(l.before="-"+l.before),i=0;i<l.before.length;i++)switch(l.before[i]){case"$":a=t._.insert(a,o.currency.symbol,i);break;case" ":a=t._.insert(a," ",i+o.currency.symbol.length-1)}for(i=l.after.length-1;i>=0;i--)switch(l.after[i]){case"$":a=i===l.after.length-1?a+o.currency.symbol:t._.insert(a,o.currency.symbol,-(l.after.length-(1+i)));break;case" ":a=i===l.after.length-1?a+" ":t._.insert(a," ",-(l.after.length-(1+i)+o.currency.symbol.length-1))}return a}}),t.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(e,r,n){var a=("number"!=typeof e||t._.isNaN(e)?"0e+0":e.toExponential()).split("e");return r=r.replace(/e[\+|\-]{1}0/,""),t._.numberToFormat(Number(a[0]),r,n)+"e"+a[1]},unformat:function(e){var r=t._.includes(e,"e+")?e.split("e+"):e.split("e-"),n=Number(r[0]),a=Number(r[1]);return a=t._.includes(e,"e-")?a*=-1:a,t._.reduce([n,Math.pow(10,a)],(function(e,r,n,a){var i=t._.correctionFactor(e,r);return e*i*(r*i)/(i*i)}),1)}}),t.register("format","ordinal",{regexps:{format:/(o)/},format:function(e,r,n){var a=t.locales[t.options.currentLocale],i=t._.includes(r," o")?" ":"";return r=r.replace(/\s?o/,""),i+=a.ordinal(e),t._.numberToFormat(e,r,n)+i}}),t.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(e,r,n){var a,i=t._.includes(r," %")?" ":"";return t.options.scalePercentBy100&&(e*=100),r=r.replace(/\s?\%/,""),a=t._.numberToFormat(e,r,n),t._.includes(a,")")?((a=a.split("")).splice(-1,0,i+"%"),a=a.join("")):a=a+i+"%",a},unformat:function(e){var r=t._.stringToNumber(e);return t.options.scalePercentBy100?.01*r:r}}),t.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(e,t,r){var n=Math.floor(e/60/60),a=Math.floor((e-60*n*60)/60),i=Math.round(e-60*n*60-60*a);return n+":"+(10>a?"0"+a:a)+":"+(10>i?"0"+i:i)},unformat:function(e){var t=e.split(":"),r=0;return 3===t.length?(r+=60*Number(t[0])*60,r+=60*Number(t[1]),r+=Number(t[2])):2===t.length&&(r+=60*Number(t[0]),r+=Number(t[1])),Number(r)}}),t}));var SUMMARY_ACTION={ADD:Symbol(),REMOVE:Symbol()},Simpler={initialize:function(){initializeUI()}};function SendData(e){e.forEach((function(e){var t=getEntry(e);t.addEventListener("click",(function(){return entryClicked(t,e)})),addToDataContainer(t)})),renderSummary(summary)}var selected=[],summary={};function calculateSummary(e,t){var r=e.currency||"LCY";switch(summary=_objectSpread({},summary,_defineProperty({},r,summary[r]||0)),t){case SUMMARY_ACTION.REMOVE:summary[r]-=e.amount;break;case SUMMARY_ACTION.ADD:summary[r]+=e.amount}}function updateSummary(e,t){calculateSummary(e,t),renderSummary(summary)}function entryClicked(e,t){selected.includes(t)?(e.classList.remove("selected"),selected=selected.filter((function(e){return e!==t})),updateSummary(t,SUMMARY_ACTION.REMOVE)):(e.classList.add("selected"),selected.push(t),updateSummary(t,SUMMARY_ACTION.ADD))}var dataContainer=document.createElement("div");dataContainer.className="data";var summaryContainer=document.createElement("div");function initializeUI(){var e=document.getElementById("controlAddIn");e.appendChild(dataContainer),e.appendChild(summaryContainer)}function emptyChildrenFrom(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function renderSummary(e){emptyChildrenFrom(summaryContainer);var t=document.createElement("div");if(t.className="label",t.innerText="Payment summary",summaryContainer.appendChild(t),!selected.length){var r=document.createElement("div");return r.className="info",r.innerText="(no invoices selected)",void summaryContainer.appendChild(r)}var n=document.createElement("table");n.width="80%";var a=document.createElement("thead");n.appendChild(a);var i=document.createElement("tr");a.appendChild(i);var o=document.createElement("td");o.width="30%",o.innerText="Currency";var l=document.createElement("td");l.width="70%",l.innerText="Amount",i.appendChild(o),i.appendChild(l);var u=document.createElement("tbody");n.appendChild(u),Object.keys(e).forEach((function(t){if(e[t]){var r=document.createElement("tr");u.appendChild(r);var n=document.createElement("td");n.innerText=t;var a=document.createElement("td");a.className="amount",a.innerText=numeral(e[t]).format("0,0.00"),r.appendChild(n),r.appendChild(a)}})),summaryContainer.appendChild(n)}function getEntry(e){var t=document.createElement("div");t.id=e.entryNo,t.className="entry";var r=document.createElement("div");r.className="date",r.innerText=e.documentDate;var n=document.createElement("div");n.className="customer";var a=document.createElement("div");a.className="no",a.innerText=e.customerNo;var i=document.createElement("div");i.className="name",i.innerText=e.customerName,n.appendChild(a),n.appendChild(i);var o=document.createElement("div");if(o.className="amount",e.currency){var l=document.createElement("span");l.className="currency",l.innerText=e.currency,o.appendChild(l)}var u=document.createElement("span");return u.className="number",u.innerText=numeral(e.amount).format("0,0.00"),o.appendChild(u),t.appendChild(r),t.appendChild(n),t.appendChild(o),t}function emptyDataContainer(){emptyChildrenFrom(dataContainer)}function addToDataContainer(e){dataContainer.append(e)}summaryContainer.className="summary";